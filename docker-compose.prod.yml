# prod file

services:
  hn-parser-node:
    container_name: hn-parser-node
    restart: unless-stopped
    image: nemanjamitic/hn-parser-node:latest
    # use single .env
    env_file:
      - .env.local
    environment:
      - PORT=3007
    # fixes file permissions for volume
    # uid=1000(username) gid=1000(username)
    user: '${MY_UID}:${MY_GID}'
    volumes:
      - ./data:/app/data
    networks:
      - proxy
    labels:
      - 'traefik.enable=true'
      - 'traefik.docker.network=proxy'
      - 'traefik.http.routers.hn-parser-node-secure.rule=Host(`${SITE_HOSTNAME}`)'
      - 'traefik.http.routers.hn-parser-node-secure.entrypoints=websecure'
      - 'traefik.http.routers.hn-parser-node-secure.service=hn-parser-node-svc'
      - 'traefik.http.services.hn-parser-node-svc.loadbalancer.server.port=3007'

networks:
  proxy:
    external: true
